\ProvidesPackage{map}[29/11/2017 package for MAP miniproject elite-map.tf.uni-erlangen.de]

\RequirePackage[a4paper,top=2cm,bottom=1.4cm,left=2.5cm,right=2.5cm,marginparwidth=0.75cm]{geometry}
% Links
\RequirePackage[colorlinks=true, allcolors=blue]{hyperref}
\RequirePackage{graphicx}
\RequirePackage{mathptmx}
\RequirePackage{tikz}
% Different line spacing
\RequirePackage{setspace}
% Tables with student data
\RequirePackage{tabularx}
\newcolumntype{s}{>{\setlength{\baselineskip}{0.7\baselineskip}\hsize=.26\textwidth}X}
\newcolumntype{S}{>{\arraybackslash}X}
\newcolumntype{Y}{>{\centering\arraybackslash}X}
% Create footer with name and matrik number
\RequirePackage{fancyhdr}
\pagestyle{fancy} 
\fancyhead{\textit{\@matrnum} \hspace*{0pt}\hfill \textit{\@author}}
\renewcommand{\headrulewidth}{0pt}
% thick lines for tables
\RequirePackage{makecell}


% MAP commands
% SUPEVISOR
\newcommand\supervisor[1]{\renewcommand\@supervisor{#1}}
\newcommand\@supervisor{\@latex@error{No \noexpand\supervisor given}\@ehc}
% DIRECT SUPEVISOR
\newcommand\dsupervisor[1]{\renewcommand\@dsupervisor{#1}}
\newcommand\@dsupervisor{\@latex@error{No \noexpand\dsupervisor given}\@ehc}
% DEPARTMENT
\newcommand\department[1]{\renewcommand\@department{#1}}
\newcommand\@department{\@latex@error{No \noexpand\department given}\@ehc}
% SEMESTER
\newcommand\semester[1]{\renewcommand\@semester{#1}}
\newcommand\@semester{\@latex@error{No \noexpand\semester given}\@ehc}
% ECTS
\newcommand\ects[1]{\renewcommand\@ects{#1}}
\newcommand\@ects{\@latex@error{No \noexpand\ects given}\@ehc}
% FOCAL SUBJECT
\newcommand\focsubj[1]{\renewcommand\@focsubj{#1}}
\newcommand\@focsubj{\@latex@error{No \noexpand\focsubj given}\@ehc}
% MATRIKEL NUM
\newcommand\matrnum[1]{\renewcommand\@matrnum{#1}}
\newcommand\@matrnum{\@latex@error{No \noexpand\matrnum given}\@ehc}
% ABSTRACT
\newcommand\myabstract[1]{\renewcommand\@myabstract{#1}}
\newcommand\@myabstract{\@latex@error{No \noexpand\myabstract given}\@ehc}
% FROM SUPERVISOR
% GRADE
\newcommand\grade[1]{\renewcommand\@grade{#1}}
\newcommand\@grade{\@latex@error{No \noexpand\grade given}\@ehc}
% COMMENTS
\newcommand\comments[1]{\renewcommand\@comments{#1}}
\newcommand\@comments{\@latex@error{No \noexpand\comments given}\@ehc}
% CITY
\newcommand\city[1]{\renewcommand\@city{#1}}
\newcommand\@city{\@latex@error{No \noexpand\city given}\@ehc}


\renewcommand*{\maketitle}{%

\begin{titlepage}
% Turn off page numbering for title pages
%\pagenumbering{gobble}
\begin{center}
	\Large{
		\textbf{Elite Master\'{}s Programme in} \\
		\textbf{Advanced Materials and Processes}
	}
\end{center}
\centering
\Large{\textbf{Miniproject Report}}
\\[2mm]
%%\centering
\textbf{\@semester}
\\[3mm]
\@title
\\[3mm]
\Large{This miniproject is in partial fulfilment (\@ects \ 
	    ECTS) of the M4 Module in the focal 
	subject "\@focsubj"}   
\\[2mm]
\vspace*{\fill}
\begin{centering}
	\begin{tabularx}{\textwidth}{|s|Y|}
		\hline
		{\small Student\'{}s Name} & 
		{\large \@author}
		\\
		\hline
		{\small Matriculation Number} &
		{\large \@matrnum}
		\\
		\hline
		{\small Senior Supervisor} & 
		{\large \@supervisor}
		\\
		\hline
		{\small Direct Supervisor (where
			applicable)} & 
		{\large \@dsupervisor}
		\\
		\hline
		{\small Institute where miniproject
			was carried out} &
		{\large \@department}
		\\
		\hline
	\end{tabularx}
\end{centering}
\\[4mm]


\fbox{\begin{minipage}[t][10.9cm][t]{0.99\textwidth}
		\normalsize{\textbf{Abstract}
		\begin{spacing}{1}
		\@myabstract
		\end{spacing}	
		}
\end{minipage}}
\\[2mm]


\begin{minipage}{\textwidth}
\begin{spacing}{1}
	\normalsize
I hereby declare that this project report is my own work, that I have only made use of the cited and/or acknowledged documents/resources and that this report has not been previously submitted as academic coursework elsewhere.
\end{spacing}
\end{minipage}
\begin{minipage}{\textwidth}
{\small \@city, \today}
\end{minipage}
\begin{tabularx}{\textwidth}{|s|S|}
		\Xhline{2pt}
	{\small City, Date} & 
	{\small Signature}
	\\
	\hline
\end{tabularx}
% Signature
\begin{tikzpicture}[remember picture,overlay] 
\node [xshift=9.81cm,yshift=3.2cm] at (current page.south west)
{
	\includegraphics[width=4.13cm]{signature}
};
\end{tikzpicture}
% MAP Logo
\begin{tikzpicture}[remember picture,overlay] 
\node [xshift=3.81cm,yshift=-2.5cm] at (current page.north west)
{
	\includegraphics[width=4.13cm]{map}
};		 
\end{tikzpicture}
% TECHFAK Logo
\begin{tikzpicture}[remember picture,overlay] 
\node [xshift=17.5cm,yshift=-2.6cm] at (current page.north west)
{
	\includegraphics[width=5.19cm]{tech_fac}
};		 
\end{tikzpicture}
\newpage
% Turn off fancy on this page
\thispagestyle{empty}
\begin{center}
	\Large{
		\textbf{Elite Master\'{}s Programme in} \\
		\textbf{Advanced Materials and Processes}
	}
\end{center}
\centering
\Large{\textbf{Miniproject Report}}
\\[2mm]
%%\centering
\textbf{\@semester}
\\[3mm]
\LARGE{\@title}
\\[3mm]
\Large{Grading Sheet}
\\[3mm]
\Large{This miniproject is in partial fulfilment (\@ects \ 
	ECTS) of the M4 Module in the focal 
	subject "\@focsubj"}   
\\[3mm]
\vspace*{\fill}
\begin{centering}
	\begin{tabularx}{\textwidth}{|s|Y|}
		\hline
		{\small Student\'{}s Name} & 
		{\large \@author}
		\\
		\hline
		{\small Matriculation Number} &
		{\large \@matrnum}
		\\
		\hline
		{\small Grade awarded} & 
		{\large \@grade}	
		\\
		\hline
		{\small Comments} &
		\multicolumn{1}{p{.64\textwidth}|}{\large \@comments}
		\\[56ex]
		\hline
	\end{tabularx}
\end{centering}
\\[2mm]
\begin{minipage}{\textwidth}
	\begin{spacing}{1}
		\normalsize
		 Note to grader: Please fill in and sign this form and return by mail or electronically to Dagmar Senft (MAP Office or \href{mailto:dagmar.senft@fau.de}{dagmar.senft@fau.de}) within 1 month after the submission.
		\end{spacing}
	\end{minipage}
\\[5mm]

\begin{tabularx}{\textwidth}{|s|S|}
\Xhline{2pt}
{\small City, Date} & 
{\small Signature}
\\
\hline
\end{tabularx}
% MAP Logo
\begin{tikzpicture}[remember picture,overlay] 
\node [xshift=3.81cm,yshift=-2.5cm] at (current page.north west)
{
	\includegraphics[width=4.13cm]{map}
};		 
\end{tikzpicture}
% TECHFAK Logo
\begin{tikzpicture}[remember picture,overlay] 
\node [xshift=17.5cm,yshift=-2.6cm] at (current page.north west)
{
	\includegraphics[width=5.19cm]{tech_fac}
};		 
\end{tikzpicture}
\end{titlepage}
}% maketitle 

\endinput